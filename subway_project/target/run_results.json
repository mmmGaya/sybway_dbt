{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-11-28T11:58:19.823046Z", "invocation_id": "b627f96e-fa87-4426-89ed-ecd80b22586c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-28T11:58:19.056456Z", "completed_at": "2024-11-28T11:58:19.086783Z"}, {"name": "execute", "started_at": "2024-11-28T11:58:19.087564Z", "completed_at": "2024-11-28T11:58:19.522724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.46860289573669434, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.subway_project.ins_to_pit_client", "compiled": true, "compiled_code": "select dataflow_id, dataflow_dttm,\n       client_rk, valid_from_dttm, valid_to_dttm,\n       client_subway_star_vf_dttm,\n       profile_client_post_vf_dttm, '1000-10-10'::timestamp client_phones_vf_dttm -- \u0437\u0430\u0433\u043b\u0443\u0448\u043a\u0430\n    from (\n    \nselect * from\n(select \n    'manual__2024-11-28T11:19:25.011076+00:00' dataflow_id, \n    '2024-11-28 11:19:25.011076+00:00'::timestamp dataflow_dttm, \n    t1.client_rk, \n    '2024-11-28 11:19:25.011076+00:00'::timestamp valid_from_dttm,\n    '5999-01-01 00:00:00'::timestamp valid_to_dttm,\n    \n        coalesce(max(t2.valid_from_dttm), max(pit.client_subway_star_vf_dttm)) client_subway_star_vf_dttm \n     ,  \n        coalesce(max(t3.valid_from_dttm), max(pit.profile_client_post_vf_dttm)) profile_client_post_vf_dttm \n     \nfrom dbt_schema.\"GPR_BV_A_CLIENT\" t1 \nleft join \n    \n    (\n        select client_rk, case when delete_flg = 1 then '1960-01-01' ::timestamp else valid_from_dttm end valid_from_dttm \n        from \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_SUBWAY_STAR\"\n        where \n         row_num = 1 and \n            actual_flg = 1  \n\t    and valid_from_dttm = \n\t    (select max(valid_from_dttm) from \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_SUBWAY_STAR\")\n            and (client_rk, valid_from_dttm) not in (select client_rk,  valid_from_dttm from dbt_schema.\"GPR_BV_P_CLIENT\")\n    ) t2 on t1.x_client_rk = t2.client_rk\n     left join  \n    \n    (\n        select client_rk, case when delete_flg = 1 then '1960-01-01' ::timestamp else valid_from_dttm end valid_from_dttm \n        from \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_PROFILE_POST\"\n        where \n         row_num = 1 and \n            actual_flg = 1  \n\t    and valid_from_dttm = \n\t    (select max(valid_from_dttm) from \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_PROFILE_POST\")\n            and (client_rk, valid_from_dttm) not in (select client_rk,  valid_from_dttm from dbt_schema.\"GPR_BV_P_CLIENT\")\n    ) t3 on t1.x_client_rk = t3.client_rk\n     \n    \njoin  (select * from dbt_schema.\"GPR_BV_P_CLIENT\" where valid_to_dttm = '5999-01-01' :: timestamp) pit\non pit.client_rk = t1.client_rk\nwhere ( t2.client_rk is not null  or  t3.client_rk is not null )\ngroup by t1.client_rk)\nwhere\n( client_subway_star_vf_dttm > '1960-01-01' :: timestamp  or   profile_client_post_vf_dttm > '1960-01-01' :: timestamp  )\n\n\n\n\n    union all\n    select * from \"postgres\".\"dbt_schema\".\"ins_new_to_pit_client\"\n    )\n\n--depends on \"postgres\".\"dbt_schema\".\"ins_new_to_pit_client\"\n--depends on \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_SUBWAY_STAR\"\n--depends on \"postgres\".\"dbt_schema\".\"GPR_RV_M_CLIENT_PROFILE_POST\"", "relation_name": "\"postgres\".\"dbt_schema\".\"ins_to_pit_client\""}], "elapsed_time": 1.8024168014526367, "args": {"printer_width": 80, "macro_debugging": false, "indirect_selection": "eager", "show_resource_report": false, "use_colors": true, "log_file_max_bytes": 10485760, "empty": false, "populate_cache": true, "project_dir": "/home/anarisuto-12/dbt/subway_project", "cache_selected_only": false, "static_parser": true, "which": "run", "require_resource_names_without_spaces": false, "strict_mode": false, "introspect": true, "quiet": false, "source_freshness_run_project_hooks": false, "print": true, "use_colors_file": true, "vars": {"execution_date": "2024-11-28T11:19:25.011076+00:00", "run_id": "manual__2024-11-28T11:19:25.011076+00:00"}, "partial_parse": true, "exclude": [], "log_level_file": "debug", "write_json": true, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "invocation_command": "dbt run --models ins_to_pit_client.sql --vars {execution_date : 2024-11-28 11:19:25.011076+00:00 , run_id :  manual__2024-11-28T11:19:25.011076+00:00 }", "select": ["ins_to_pit_client.sql"], "version_check": true, "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "enable_legacy_logger": false, "favor_state": false, "log_path": "/home/anarisuto-12/dbt/subway_project/logs", "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "defer": false, "profiles_dir": "/home/anarisuto-12/.dbt"}}